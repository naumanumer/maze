/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};function e(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function n(t){return"function"==typeof t}var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function o(t){setTimeout((function(){throw t}),0)}var s={closed:!0,next:function(t){},error:function(t){if(i.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete:function(){}},c=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function u(t){return null!==t&&"object"==typeof t}var a=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),h=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,i=r._parentOrParents,o=r._ctorUnsubscribe,s=r._unsubscribe,h=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof t)i.remove(this);else if(null!==i)for(var f=0;f<i.length;++f){i[f].remove(this)}if(n(s)){o&&(this._unsubscribe=void 0);try{s.call(this)}catch(t){e=t instanceof a?l(t.errors):[t]}}if(c(h)){f=-1;for(var p=h.length;++f<p;){var d=h[f];if(u(d))try{d.unsubscribe()}catch(t){e=e||[],t instanceof a?e=e.concat(l(t.errors)):e.push(t)}}}if(e)throw new a(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function l(t){return t.reduce((function(t,e){return t.concat(e instanceof a?e.errors:e)}),[])}var f=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),p=function(t){function n(e,r,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=s;break;case 1:if(!e){o.destination=s;break}if("object"==typeof e){e instanceof n?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(o)):(o.syncErrorThrowable=!0,o.destination=new d(o,e));break}default:o.syncErrorThrowable=!0,o.destination=new d(o,e,r,i)}return o}return e(n,t),n.prototype[f]=function(){return this},n.create=function(t,e,r){var i=new n(t,e,r);return i.syncErrorThrowable=!1,i},n.prototype.next=function(t){this.isStopped||this._next(t)},n.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},n.prototype._next=function(t){this.destination.next(t)},n.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},n}(h),d=function(t){function r(e,r,i,o){var c,u=t.call(this)||this;u._parentSubscriber=e;var a=u;return n(r)?c=r:r&&(c=r.next,i=r.error,o=r.complete,r!==s&&(n((a=Object.create(r)).unsubscribe)&&u.add(a.unsubscribe.bind(a)),a.unsubscribe=u.unsubscribe.bind(u))),u._context=a,u._next=c,u._error=i,u._complete=o,u}return e(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;i.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=i.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;o(t)}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};i.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),i.useDeprecatedSynchronousErrorHandling)throw t;o(t)}},r.prototype.__tryOrSetError=function(t,e,n){if(!i.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return i.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(o(e),!0)}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},r}(p);var v=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function y(t){return t}function b(t){return 0===t.length?y:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var m=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=function(t,e,n){if(t){if(t instanceof p)return t;if(t[f])return t[f]()}return t||e||n?new p(t,e,n):new p(s)}(t,e,n);if(r?o.add(r.call(o,this.source)):o.add(this.source||i.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),i.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){i.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof p?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=g(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(t){r(t),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[v]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:b(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=g(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function g(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var w=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),_=function(t){function n(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return e(n,t),n.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},n}(h),E=function(t){function n(e){var n=t.call(this,e)||this;return n.destination=e,n}return e(n,t),n}(p),T=function(t){function n(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return e(n,t),n.prototype[f]=function(){return new E(this)},n.prototype.lift=function(t){var e=new x(this,this);return e.operator=t,e},n.prototype.next=function(t){if(this.closed)throw new w;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},n.prototype.error=function(t){if(this.closed)throw new w;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},n.prototype.complete=function(){if(this.closed)throw new w;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},n.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},n.prototype._trySubscribe=function(e){if(this.closed)throw new w;return t.prototype._trySubscribe.call(this,e)},n.prototype._subscribe=function(t){if(this.closed)throw new w;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new _(this,t))},n.prototype.asObservable=function(){var t=new m;return t.source=this,t},n.create=function(t,e){return new x(t,e)},n}(m),x=function(t){function n(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return e(n,t),n.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},n.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},n.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},n.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):h.EMPTY},n}(T);function S(){return function(t){return t.lift(new C(t))}}var C=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new I(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),I=function(t){function n(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return e(n,t),n.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},n}(p),M=function(t){function n(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return e(n,t),n.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},n.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new h).add(this.source.subscribe(new N(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t},n.prototype.refCount=function(){return S()(this)},n}(m),A=function(){var t=M.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),N=function(t){function n(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return e(n,t),n.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},n}(E),O=function(t){function n(e){var n=t.call(this)||this;return n._value=e,n}return e(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),n.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},n.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new w;return this._value},n.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},n}(T),P=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return e(n,t),n.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},n.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},n.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},n.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},n.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},n.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},n}(function(t){function n(e,n){return t.call(this)||this}return e(n,t),n.prototype.schedule=function(t,e){return this},n}(h)),k=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),j=function(t){function n(e,r){void 0===r&&(r=k.now);var i=t.call(this,e,(function(){return n.delegate&&n.delegate!==i?n.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return e(n,t),n.prototype.schedule=function(e,r,i){return void 0===r&&(r=0),n.delegate&&n.delegate!==this?n.delegate.schedule(e,r,i):t.prototype.schedule.call(this,e,r,i)},n.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},n}(k),z=new m((function(t){return t.complete()}));function D(t){return t?function(t){return new m((function(e){return t.schedule((function(){return e.complete()}))}))}(t):z}function R(t){return t&&"function"==typeof t.schedule}var W=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};function F(t,e){return new m((function(n){var r=new h,i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function Y(t,e){return e?F(t,e):new m(W(t))}function L(t){var e=t.error;t.subscriber.error(e)}var V=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){var t,e;switch(this.kind){case"N":return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return R(n)?(t.pop(),F(t,n)):Y(t)}(this.value);case"E":return t=this.error,new m(e?function(n){return e.schedule(L,0,{error:t,subscriber:n})}:function(e){return e.error(t)});case"C":return D()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();function H(t,e){return void 0===e&&(e=0),function(n){return n.lift(new X(t,e))}}var X=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new q(t,this.scheduler,this.delay))},t}(),q=function(t){function n(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return e(n,t),n.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},n.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new U(t,this.destination)))},n.prototype._next=function(t){this.scheduleMessage(V.createNext(t))},n.prototype._error=function(t){this.scheduleMessage(V.createError(t)),this.unsubscribe()},n.prototype._complete=function(){this.scheduleMessage(V.createComplete()),this.unsubscribe()},n}(p),U=function(){return function(t,e){this.notification=t,this.destination=e}}(),B=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return e(n,t),n.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},n.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},n}(P),$=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},n}(j))(B);function Z(){}function G(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new K(t,e))}}var K=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new J(t,this.project,this.thisArg))},t}(),J=function(t){function n(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return e(n,t),n.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},n}(p),Q=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},n.prototype.notifyError=function(t,e){this.destination.error(t)},n.prototype.notifyComplete=function(t){this.destination.complete()},n}(p),tt=function(t){function n(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return e(n,t),n.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},n.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},n.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},n}(p);function et(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var nt=et(),rt=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function it(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var ot=function(t){if(t&&"function"==typeof t[v])return r=t,function(t){var e=r[v]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(rt(t))return W(t);if(it(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,o),t};if(t&&"function"==typeof t[nt])return e=t,function(t){for(var n=e[nt]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,i=u(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function st(t,e,n,r,i){if(void 0===i&&(i=new tt(t,n,r)),!i.closed)return e instanceof m?e.subscribe(i):ot(e)(i)}function ct(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[v]}(t))return function(t,e){return new m((function(n){var r=new h;return r.add(e.schedule((function(){var i=t[v]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(it(t))return function(t,e){return new m((function(n){var r=new h;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(rt(t))return F(t,e);if(function(t){return t&&"function"==typeof t[nt]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new m((function(n){var r,i=new h;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(e.schedule((function(){r=t[nt](),i.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var ut=function(t){function n(e){var n=t.call(this)||this;return n.parent=e,n}return e(n,t),n.prototype._next=function(t){this.parent.notifyNext(t)},n.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},n.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},n}(p),at=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.notifyNext=function(t){this.destination.next(t)},n.prototype.notifyError=function(t){this.destination.error(t)},n.prototype.notifyComplete=function(){this.destination.complete()},n}(p);function ht(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(ht((function(n,r){return(i=t(n,r),o?ct(i,o):i instanceof m?i:new m(ot(i))).pipe(G((function(t,i){return e(n,t,r,i)})));var i,o}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new lt(t,n))})}var lt=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new ft(t,this.project,this.concurrent))},t}(),ft=function(t){function n(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return e(n,t),n.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},n.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},n.prototype._innerSub=function(t){var e=new ut(this),n=this.destination;n.add(e);var r=function(t,e){if(!e.closed)return t instanceof m?t.subscribe(e):ot(t)(e)}(t,e);r!==e&&n.add(r)},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(t){this.destination.next(t)},n.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},n}(at);function pt(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),ht(y,t)}function dt(t,e,r,i){return n(r)&&(i=r,r=void 0),i?dt(t,e,r).pipe(G((function(t){return c(t)?i.apply(void 0,t):i(t)}))):new m((function(n){vt(t,e,(function(t){arguments.length>1?n.next(Array.prototype.slice.call(arguments)):n.next(t)}),n,r)}))}function vt(t,e,n,r,i){var o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,i),o=function(){return s.removeEventListener(e,n,i)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var c=t;t.on(e,n),o=function(){return c.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var u=t;t.addListener(e,n),o=function(){return u.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var a=0,h=t.length;a<h;a++)vt(t[a],e,n,r,i)}r.add(o)}function yt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,i=t[t.length-1];return R(i)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof i&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof m?t[0]:pt(n)(Y(t,r))}function bt(t,e){return function(n){return n.lift(new mt(t,e))}}var mt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new gt(t,this.predicate,this.thisArg))},t}(),gt=function(t){function n(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return e(n,t),n.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},n}(p);var wt=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new _t(t,this.compare,this.keySelector))},t}(),_t=function(t){function n(e,n,r){var i=t.call(this,e)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return e(n,t),n.prototype.compare=function(t,e){return t===e},n.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},n}(p);var Et=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}();function Tt(){return new T}function xt(){return function(t){return S()((e=Tt,function(t){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof n)return t.lift(new Et(r,n));var i=Object.create(t,A);return i.source=t,i.subjectFactory=r,i})(t));var e,n}}function St(t,e,n){return function(r){return r.lift(new Ct(t,e,n))}}var Ct=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new It(t,this.nextOrObserver,this.error,this.complete))},t}(),It=function(t){function r(e,r,i,o){var s=t.call(this,e)||this;return s._tapNext=Z,s._tapError=Z,s._tapComplete=Z,s._tapError=i||Z,s._tapComplete=o||Z,n(r)?(s._context=s,s._tapNext=r):r&&(s._context=r,s._tapNext=r.next||Z,s._tapError=r.error||Z,s._tapComplete=r.complete||Z),s}return e(r,t),r.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},r.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},r.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},r}(p);function Mt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new At(r,n))}}var At=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new Nt(t,this.observables,this.project))},t}(),Nt=function(t){function n(e,n,r){var i=t.call(this,e)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var s=0;s<o;s++)i.toRespond.push(s);for(s=0;s<o;s++){var c=n[s];i.add(st(i,c,void 0,s))}return i}return e(n,t),n.prototype.notifyNext=function(t,e,n){this.values[n]=e;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},n.prototype.notifyComplete=function(){},n.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},n.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},n}(Q);
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
var Ot,Pt=function(t){var e={exports:{}};return t(e,e.exports),e.exports}((function(t){!function(e,n,r,i){var o,s=["","webkit","Moz","MS","ms","o"],c=n.createElement("div"),u=Math.round,a=Math.abs,h=Date.now;function l(t,e,n){return setTimeout(m(t,n),e)}function f(t,e,n){return!!Array.isArray(t)&&(p(t,n[e],n),!0)}function p(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==i)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function d(t,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,i,r),t.apply(this,arguments)}}o="function"!=typeof Object.assign?function(t){if(t===i||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}:Object.assign;var v=d((function(t,e,n){for(var r=Object.keys(e),o=0;o<r.length;)(!n||n&&t[r[o]]===i)&&(t[r[o]]=e[r[o]]),o++;return t}),"extend","Use `assign`."),y=d((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function b(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&o(r,n)}function m(t,e){return function(){return t.apply(e,arguments)}}function g(t,e){return"function"==typeof t?t.apply(e&&e[0]||i,e):t}function w(t,e){return t===i?e:t}function _(t,e,n){p(S(e),(function(e){t.addEventListener(e,n,!1)}))}function E(t,e,n){p(S(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function x(t,e){return t.indexOf(e)>-1}function S(t){return t.trim().split(/\s+/g)}function C(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function M(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];C(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function A(t,e){for(var n,r,o=e[0].toUpperCase()+e.slice(1),c=0;c<s.length;){if((r=(n=s[c])?n+o:e)in t)return r;c++}return i}var N=1;function O(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var P="ontouchstart"in e,k=A(e,"PointerEvent")!==i,j=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z="touch",D="mouse",R=24,W=["x","y"],F=["clientX","clientY"];function Y(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){g(t.options.enable,[t])&&n.handler(e)},this.init()}function L(t,e,n){var r=n.pointers.length,o=n.changedPointers.length,s=1&e&&r-o==0,c=12&e&&r-o==0;n.isFirst=!!s,n.isFinal=!!c,s&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,o=r.length;n.firstInput||(n.firstInput=V(e));o>1&&!n.firstMultiple?n.firstMultiple=V(e):1===o&&(n.firstMultiple=!1);var s=n.firstInput,c=n.firstMultiple,u=c?c.center:s.center,l=e.center=H(r);e.timeStamp=h(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=B(u,l),e.distance=U(u,l),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var f=X(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=f.x,e.overallVelocityY=f.y,e.overallVelocity=a(f.x)>a(f.y)?f.x:f.y,e.scale=c?(p=c.pointers,d=r,U(d[0],d[1],F)/U(p[0],p[1],F)):1,e.rotation=c?function(t,e){return B(e[1],e[0],F)+B(t[1],t[0],F)}(c.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,o,s,c=t.lastInterval||e,u=e.timeStamp-c.timeStamp;if(8!=e.eventType&&(u>25||c.velocity===i)){var h=e.deltaX-c.deltaX,l=e.deltaY-c.deltaY,f=X(u,h,l);r=f.x,o=f.y,n=a(f.x)>a(f.y)?f.x:f.y,s=q(h,l),t.lastInterval=e}else n=c.velocity,r=c.velocityX,o=c.velocityY,s=c.direction;e.velocity=n,e.velocityX=r,e.velocityY=o,e.direction=s}(n,e);var p,d;var v=t.element;T(e.srcEvent.target,v)&&(v=e.srcEvent.target);e.target=v}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function V(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:u(t.pointers[n].clientX),clientY:u(t.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:u(t[0].clientX),y:u(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:u(n/e),y:u(r/e)}}function X(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:a(t)>=a(e)?t<0?2:4:e<0?8:16}function U(t,e,n){n||(n=W);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function B(t,e,n){n||(n=W);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}Y.prototype={handler:function(){},init:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(O(this.element),this.evWin,this.domHandler)}};var $={mousedown:1,mousemove:2,mouseup:4},Z="mousedown",G="mousemove mouseup";function K(){this.evEl=Z,this.evWin=G,this.pressed=!1,Y.apply(this,arguments)}b(K,Y,{handler:function(t){var e=$[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:D,srcEvent:t}))}});var J={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:z,3:"pen",4:D,5:"kinect"},tt="pointerdown",et="pointermove pointerup pointercancel";function nt(){this.evEl=tt,this.evWin=et,Y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(tt="MSPointerDown",et="MSPointerMove MSPointerUp MSPointerCancel"),b(nt,Y,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=J[r],o=Q[t.pointerType]||t.pointerType,s=o==z,c=C(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?c<0&&(e.push(t),c=e.length-1):12&i&&(n=!0),c<0||(e[c]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(c,1))}});var rt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},it="touchstart",ot="touchstart touchmove touchend touchcancel";function st(){this.evTarget=it,this.evWin=ot,this.started=!1,Y.apply(this,arguments)}function ct(t,e){var n=I(t.touches),r=I(t.changedTouches);return 12&e&&(n=M(n.concat(r),"identifier",!0)),[n,r]}b(st,Y,{handler:function(t){var e=rt[t.type];if(1===e&&(this.started=!0),this.started){var n=ct.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:z,srcEvent:t})}}});var ut={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=at,this.targetIds={},Y.apply(this,arguments)}function lt(t,e){var n=I(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=I(t.changedTouches),c=[],u=this.target;if(o=n.filter((function(t){return T(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&c.push(s[i]),12&e&&delete r[s[i].identifier],i++;return c.length?[M(o.concat(c),"identifier",!0),c]:void 0}b(ht,Y,{handler:function(t){var e=ut[t.type],n=lt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:z,srcEvent:t})}});function ft(){Y.apply(this,arguments);var t=m(this.handler,this);this.touch=new ht(this.manager,t),this.mouse=new K(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function pt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,dt.call(this,e)):12&t&&dt.call(this,e)}function dt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function vt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}b(ft,Y,{handler:function(t,e,n){var r=n.pointerType==z,i=n.pointerType==D;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)pt.call(this,e,n);else if(i&&vt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var yt=A(c.style,"touchAction"),bt=yt!==i,mt="compute",gt="auto",wt="manipulation",_t="none",Et="pan-x",Tt="pan-y",xt=function(){if(!bt)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){t[r]=!n||e.CSS.supports("touch-action",r)})),t}();function St(t,e){this.manager=t,this.set(e)}St.prototype={set:function(t){t==mt&&(t=this.compute()),bt&&this.manager.element.style&&xt[t]&&(this.manager.element.style[yt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return p(this.manager.recognizers,(function(e){g(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(x(t,_t))return _t;var e=x(t,Et),n=x(t,Tt);if(e&&n)return _t;if(e||n)return e?Et:Tt;if(x(t,wt))return wt;return gt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=x(r,_t)&&!xt.none,o=x(r,Tt)&&!xt["pan-y"],s=x(r,Et)&&!xt["pan-x"];if(i){var c=1===t.pointers.length,u=t.distance<2,a=t.deltaTime<250;if(c&&u&&a)return}if(!s||!o)return i||o&&6&n||s&&n&R?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function It(t){this.options=o({},this.defaults,t||{}),this.id=N++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Mt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function At(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Nt(t,e){var n=e.manager;return n?n.get(t):t}function Ot(){It.apply(this,arguments)}function Pt(){Ot.apply(this,arguments),this.pX=null,this.pY=null}function kt(){Ot.apply(this,arguments)}function jt(){It.apply(this,arguments),this._timer=null,this._input=null}function zt(){Ot.apply(this,arguments)}function Dt(){Ot.apply(this,arguments)}function Rt(){It.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Wt(t,e){return(e=e||{}).recognizers=w(e.recognizers,Wt.defaults.preset),new Ft(t,e)}It.prototype={defaults:{},set:function(t){return o(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(f(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Nt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return f(t,"dropRecognizeWith",this)||(t=Nt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(f(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Nt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(f(t,"dropRequireFailure",this))return this;t=Nt(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+Mt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+Mt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=o({},t);if(!g(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},b(Ot,It,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Ct}}),b(Pt,Ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(Tt),t&R&&e.push(Et),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Ot.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=At(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),b(kt,Ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),b(jt,It,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[gt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=l((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),b(zt,Ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),b(Dt,Ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Pt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&R&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&a(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=At(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),b(Rt,It,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||U(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=l((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=l((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Wt.VERSION="2.0.7",Wt.defaults={domEvents:!1,touchAction:mt,enable:!0,inputTarget:null,inputClass:null,preset:[[zt,{enable:!1}],[kt,{enable:!1},["rotate"]],[Dt,{direction:6}],[Pt,{direction:6},["swipe"]],[Rt],[Rt,{event:"doubletap",taps:2},["tap"]],[jt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ft(t,e){var n;this.options=o({},Wt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(k?nt:j?ht:P?ft:K))(n,L),this.touchAction=new St(this,this.options.touchAction),Yt(this,!0),p(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Yt(t,e){var n,r=t.element;r.style&&(p(t.options.cssProps,(function(i,o){n=A(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ft.prototype={set:function(t){return o(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof It)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(f(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(f(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=C(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==i&&e!==i){var n=this.handlers;return p(S(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==i){var n=this.handlers;return p(S(t),(function(t){e?n[t]&&n[t].splice(C(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var r=n.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e,e.target.dispatchEvent(r)}(t,e);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](e),i++}},destroy:function(){this.element&&Yt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},o(Wt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:R,DIRECTION_ALL:30,Manager:Ft,Input:Y,TouchAction:St,TouchInput:ht,MouseInput:K,PointerEventInput:nt,TouchMouseInput:ft,SingleTouchInput:st,Recognizer:It,AttrRecognizer:Ot,Tap:Rt,Pan:Pt,Swipe:Dt,Pinch:kt,Rotate:zt,Press:jt,on:_,off:E,each:p,merge:y,extend:v,assign:o,inherit:b,bindFn:m,prefixed:A}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Wt,t.exports?t.exports=Wt:e.Hammer=Wt}(window,document)}));!function(t){t[t.recursiveBackTrack=0]="recursiveBackTrack"}(Ot||(Ot={}));var kt,jt=new class{constructor(){this.generators=new Map}async loadGenerator(t){if(this.generators.has(t))return this.generators.get(t);let e;switch(t){case Ot.recursiveBackTrack:e=(await import("./recursiveBackTrack.es.js")).default}const n=new e;return this.generators.set(t,n),n}};!function(t){t[t.rectangularSvg=0]="rectangularSvg"}(kt||(kt={}));var zt=new class{constructor(){this.renderers=new Map}async loadRenderer(t){if(this.renderers.has(t))return this.renderers.get(t);let e;switch(t){case kt.rectangularSvg:e=(await import("./rectangularSvg.es.js")).default}const n=new e;return this.renderers.set(t,n),n}},Dt={};!function t(e,n,r,i){var o=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL);function s(){}function c(t){var r=n.exports.Promise,i=void 0!==r?r:e.Promise;return"function"==typeof i?new i(t):(t(s,s),null)}var u,a,h,l,f,p,d,v,y=(h=Math.floor(1e3/60),l={},f=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(u=function(t){var e=Math.random();return l[e]=requestAnimationFrame((function n(r){f===r||f+h-1<r?(f=r,delete l[e],t()):l[e]=requestAnimationFrame(n)})),e},a=function(t){l[t]&&cancelAnimationFrame(l[t])}):(u=function(t){return setTimeout(t,h)},a=function(t){return clearTimeout(t)}),{frame:u,cancel:a}),b=(v={},function(){if(p)return p;if(!r&&o){var e=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{p=new Worker(URL.createObjectURL(new Blob([e])))}catch(t){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Could not load worker",t),null}!function(t){function e(e,n){t.postMessage({options:e||{},callback:n})}t.init=function(e){var n=e.transferControlToOffscreen();t.postMessage({canvas:n},[n])},t.fire=function(n,r,i){if(d)return e(n,null),d;var o=Math.random().toString(36).slice(2);return d=c((function(r){function s(e){e.data.callback===o&&(delete v[o],t.removeEventListener("message",s),d=null,i(),r())}t.addEventListener("message",s),e(n,o),v[o]=s.bind(null,{data:{callback:o}})}))},t.reset=function(){for(var e in t.postMessage({reset:!0}),v)v[e](),delete v[e]}}(p)}return p}),m={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function g(t,e,n){return function(t,e){return e?e(t):t}(t&&null!=t[e]?t[e]:m[e],n)}function w(t){return t<0?0:Math.floor(t)}function _(t){return parseInt(t,16)}function E(t){return t.map(T)}function T(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:_(e.substring(0,2)),g:_(e.substring(2,4)),b:_(e.substring(4,6))}}function x(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function S(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function C(t,e,n,o,s){var u,a,h=e.slice(),l=t.getContext("2d"),f=c((function(e){function c(){u=a=null,l.clearRect(0,0,o.width,o.height),s(),e()}u=y.frame((function e(){!r||o.width===i.width&&o.height===i.height||(o.width=t.width=i.width,o.height=t.height=i.height),o.width||o.height||(n(t),o.width=t.width,o.height=t.height),l.clearRect(0,0,o.width,o.height),(h=h.filter((function(t){return function(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.wobble+=.1,e.velocity*=e.decay,e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+5,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble);var n=e.tick++/e.totalTicks,r=e.x+e.random*e.tiltCos,i=e.y+e.random*e.tiltSin,o=e.wobbleX+e.random*e.tiltCos,s=e.wobbleY+e.random*e.tiltSin;return t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-n)+")",t.beginPath(),"circle"===e.shape?t.ellipse?t.ellipse(e.x,e.y,Math.abs(o-r)*e.ovalScalar,Math.abs(s-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):function(t,e,n,r,i,o,s,c,u){t.save(),t.translate(e,n),t.rotate(o),t.scale(r,i),t.arc(0,0,1,s,c,u),t.restore()}(t,e.x,e.y,Math.abs(o-r)*e.ovalScalar,Math.abs(s-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):(t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(i)),t.lineTo(Math.floor(o),Math.floor(s)),t.lineTo(Math.floor(r),Math.floor(e.wobbleY))),t.closePath(),t.fill(),e.tick<e.totalTicks}(l,t)}))).length?u=y.frame(e):c()})),a=c}));return{addFettis:function(t){return h=h.concat(t),f},canvas:t,promise:f,reset:function(){u&&y.cancel(u),a&&a()}}}function I(t,n){var r,i=!t,s=!!g(n||{},"resize"),u=g(n,"disableForReducedMotion",Boolean),a=o&&!!g(n||{},"useWorker")?b():null,h=i?x:S,l=!(!t||!a)&&!!t.__confetti_initialized,f="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function p(e,n,i){for(var o,s,c,u,a,l=g(e,"particleCount",w),f=g(e,"angle",Number),p=g(e,"spread",Number),d=g(e,"startVelocity",Number),v=g(e,"decay",Number),y=g(e,"gravity",Number),b=g(e,"drift",Number),m=g(e,"colors",E),_=g(e,"ticks",Number),T=g(e,"shapes"),x=g(e,"scalar"),S=function(t){var e=g(t,"origin",Object);return e.x=g(e,"x",Number),e.y=g(e,"y",Number),e}(e),I=l,M=[],A=t.width*S.x,N=t.height*S.y;I--;)M.push((o={x:A,y:N,angle:f,spread:p,startVelocity:d,color:m[I%m.length],shape:T[(u=0,a=T.length,Math.floor(Math.random()*(a-u))+u)],ticks:_,decay:v,gravity:y,drift:b,scalar:x},s=void 0,c=void 0,s=o.angle*(Math.PI/180),c=o.spread*(Math.PI/180),{x:o.x,y:o.y,wobble:10*Math.random(),velocity:.5*o.startVelocity+Math.random()*o.startVelocity,angle2D:-s+(.5*c-Math.random()*c),tiltAngle:Math.random()*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+5,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*o.gravity,ovalScalar:.6,scalar:o.scalar}));return r?r.addFettis(M):(r=C(t,M,h,n,i)).promise}function d(n){var o=u||g(n,"disableForReducedMotion",Boolean),d=g(n,"zIndex",Number);if(o&&f)return c((function(t){t()}));i&&r?t=r.canvas:i&&!t&&(t=function(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}(d),document.body.appendChild(t)),s&&!l&&h(t);var v={width:t.width,height:t.height};function y(){if(a){var e={getBoundingClientRect:function(){if(!i)return t.getBoundingClientRect()}};return h(e),void a.postMessage({resize:{width:e.width,height:e.height}})}v.width=v.height=null}function b(){r=null,s&&e.removeEventListener("resize",y),i&&t&&(document.body.removeChild(t),t=null,l=!1)}return a&&!l&&a.init(t),l=!0,a&&(t.__confetti_initialized=!0),s&&e.addEventListener("resize",y,!1),a?a.fire(n,v,b):p(n,v,b)}return d.reset=function(){a&&a.reset(),r&&r.reset()},d}n.exports=I(null,{useWorker:!0,resize:!0}),n.exports.create=I}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),Dt,!1);var Rt=Dt.exports;Dt.exports.create;const Wt={ArrowRight:"right",ArrowLeft:"left",ArrowUp:"up",ArrowDown:"down"};const Ft={left:"right",right:"left",up:"down",down:"up"};class Yt{constructor(t){this.position=t,this.walls=new Map,this.setAllWalls()}setAllWalls(){this.setWall("up"),this.setWall("right"),this.setWall("down"),this.setWall("left")}removeAllWalls(){this.removeWall("up"),this.removeWall("right"),this.removeWall("down"),this.removeWall("left")}setWall(t){this.walls.set(t,!0)}removeWall(t){this.walls.set(t,!1)}hasWall(t){return this.walls.get(t)}clone(){const t=new Yt(this.position);for(const[e,n]of this.walls.entries())t.walls.set(e,n);return t}}class Lt{constructor(t,e){this.x=t,this.y=e}static from(t){return t instanceof Lt?t:new Lt(t.x,t.y)}toIndex(t){return this.y*t+this.x}stringify(){return`${this.x}-${this.y}`}}class Vt{constructor(t,e){this.size={height:e,width:t},this.cells=[],this.initCells()}initCells(){for(let t=0;t<this.size.height;t++)for(let e=0;e<this.size.width;e++)this.cells.push(new Yt(new Lt(e,t)))}getRandomCell(){return this.cells[Math.round(Math.random()*(this.cells.length-1))]}getCell(t){return this.cells[Lt.from(t).toIndex(this.size.width)]}getNeighbourCells(t,e=!1){let n=new Map,r=Lt.from(t).toIndex(this.size.width);if(r>=this.size.width){const t=this.cells[r-this.size.width];n.set("up",t)}if((r+1)%this.size.width!=0){const t=this.cells[r+1];n.set("right",t)}if(r<this.cells.length-this.size.width){const t=this.cells[r+this.size.width];n.set("down",t)}if(r%this.size.width!=0){const t=this.cells[r-1];n.set("left",t)}if(e){const e=Array.from(n.entries()).filter((([e,n])=>!this.hasInterWall(n.position,t)));n=new Map(e)}return n}getNeighbourCell(t,e){return this.getNeighbourCells(t).get(e)}getRelativeDirection(t,e){if(t.y===e.y+1)return"up";if(t.x===e.x-1)return"right";if(t.x===e.x+1)return"left";if(t.y===e.y-1)return"down";throw`'${t}' and '${e}' are not neighbours`}removeInterWall(t,e){const n=this.getRelativeDirection(t,e),r=Ft[n];this.getCell(t).removeWall(n),this.getCell(e).removeWall(r)}addInterWall(t,e){const n=this.getRelativeDirection(t,e),r=Ft[n];this.getCell(t).setWall(n),this.getCell(e).setWall(r)}hasInterWall(t,e){const n=this.getRelativeDirection(t,e),r=Ft[n];return this.getCell(t).hasWall(n)&&this.getCell(e).hasWall(r)}isConnected(t,e){const n=this.getRelativeDirection(t,e),r=Ft[n];return this.getCell(t).hasWall(n)&&this.getCell(e).hasWall(r)}hasWall(t,e){return this.getCell(t).hasWall(e)}clone(){const t=new Vt(this.size.width,this.size.height);for(let e=0;e<t.cells.length;e++)t.cells[e]=this.cells[e].clone();return t}}const Ht=new O(null);function Xt(){Ht.next(Ht.getValue())}const qt=document.getElementById("board"),Ut=document.getElementById("boardWrapper"),Bt=document.getElementById("reset"),$t=dt(window,"keydown").pipe(bt((t=>!(t.metaKey||t.ctrlKey))),G((t=>({type:t.key,claim(){t.preventDefault(),t.stopPropagation()}}))),bt((()=>{const t=document.activeElement instanceof HTMLElement?document.activeElement:void 0;return void 0===t||!function(t){switch(t.tagName){case"INPUT":case"SELECT":case"TEXTAREA":return!0;default:return t.isContentEditable}}(t)})),xt()),Zt=function(t=document.documentElement){const e=new Pt.Manager(t);return e.add(new Pt.Swipe),yt(dt(e,"swipeleft"),dt(e,"swiperight"),dt(e,"swipeup"),dt(e,"swipedown")).pipe(G((({type:t})=>({dir:t.slice(5)}))),xt())}(Ut),Gt=Ht.pipe(bt((t=>!!t)),ht((async({width:t,height:e,generator:n})=>{let r=new Vt(t,e);return r=(await jt.loadGenerator(n)).generate(r),r}),Kt,1),xt());var Kt;const Jt=function({keyboard$:t,swipe$:e,board$:n}){const r=new O({visible:!0,position:{x:0,y:0}});return n.pipe(Mt(r),St((([t,{position:e}])=>{0===e.x&&0===e.y||r.next({visible:!0,position:{x:0,y:0}})}))).subscribe(),yt(t,e).pipe(G((t=>t.type?{dir:Wt[t.type]}:t))).pipe(Mt(r,n),St((([{dir:t},e,n])=>{let{x:i,y:o}=e.position;if(!(i>=n.size.width||o>=n.size.height||n.hasWall({x:i,y:o},t))){for(;;){"right"===t&&i<n.size.width-1?i++:"left"===t&&i>0?i--:"up"===t&&o>0?o--:"down"===t&&o<n.size.height-1&&o++;const e=n.getNeighbourCells({x:i,y:o},!0);if(!e.has(t)||e.size>2)break}i===n.size.width-1&&o===n.size.height-1&&setTimeout((()=>{r.next({visible:!0,position:{x:i+1,y:o}}),Rt({origin:{y:.8},particleCount:200}).then()}),250),r.next({visible:!0,position:{x:i,y:o}})}}))).subscribe(),r.pipe(H($),(i=(t,e)=>t.visible===e.visible&&t.position.x===e.position.x&&t.position.y===e.position.y,function(t){return t.lift(new wt(i,o))}));var i,o}({keyboard$:$t,board$:Gt,swipe$:Zt});var Qt;Gt.pipe(H($)).subscribe((t=>{zt.loadRenderer(kt.rectangularSvg).then((e=>{for(;qt.lastElementChild;)qt.removeChild(qt.lastElementChild);qt.appendChild(e.render(t,Jt))}))})),$t.subscribe((({type:t})=>{"r"===t.toLowerCase()&&Xt()})),Qt={height:20,width:20,generator:Ot.recursiveBackTrack},Ht.next(Qt),dt(Bt,"click").subscribe(Xt);export{p as S,e as _};
//# sourceMappingURL=main.es.js.map
